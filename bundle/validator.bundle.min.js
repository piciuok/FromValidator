!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(e=e||self).Validator=r()}(this,function(){"use strict";"function"!=typeof Object.assign&&(Object.assign=function(e,r){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),o=1;o<arguments.length;o++){var i=arguments[o];if(null!=i)for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}),"NodeList"in window&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,r){r=r||window;for(var t=0;t<this.length;t++)e.call(r,this[t],t,this)});var e={required:{valid:(e,r)=>{if("radio"===r.type||"checkbox"===r.type){const e=document.getElementsByName(r.name);let t=!1;return e.forEach(e=>!!t||(e.checked?(t=!0,!0):void 0)),t}return"select"===r.type?""!==e:0!==e.length}},phone:{valid:(e,r)=>{return/^([0-9]{9})$/.test(e)}},email:{valid:(e,r)=>{return/\S+@\S+\.\S+/.test(e)}},password:{valid:(e,r)=>{return new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\\$%\\^&])(?=.{8,})").test(e)}},pesel:{valid:(e,r)=>{if(11!==e.length)return!1;parseInt(e.substr(0,2));let t=parseInt(e.substr(2,2)),o=parseInt(e.substr(4,2));return(!(t>12||t<1)||!(t<21||t>32))&&!(o>31)}},regon:{valid:(e,r)=>{let t=[8,9,2,3,4,5,6,7],o=[2,4,8,5,0,9,7,3,6,1,2,4,8],i=0,n=0,s=0;if(/(\d{14}|\d{9})/.test(e)&&(9===e.length||14===e.length)){if(9===e.length){for(let r=0;r<8;r++)i+=parseInt(e[r])*t[r];if(s=10===(n=i%11)?0:n,parseInt(e.charAt(8))===s)return!0}if(14===e.length){for(let r=0;r<13;r++)i+=parseInt(e[r])*o[r];if(s=10===(n=i%11)?0:n,parseInt(e.charAt(13))===s)return!0}}return!1}},nip:{valid:function(e,r){let t=e.replace("-","",e);if(10!==t.length)return!1;let o=t.split(""),i=(6*parseInt(o[0])+5*parseInt(o[1])+7*parseInt(o[2])+2*parseInt(o[3])+3*parseInt(o[4])+4*parseInt(o[5])+5*parseInt(o[6])+6*parseInt(o[7])+7*parseInt(o[8]))%11;return parseInt(o[9])===i}},idCard:{valid:function(e,r){if(null==e||9!==e.length)return!1;let t,o,i,n;function s(e){for(o=0;o<n.length;o++)if(e===n[o])return o;return-1}for(e=e.toUpperCase(),n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],t=0;t<3;t++)if(s(e[t])<10)return!1;for(t=3;t<9;t++)if(s(e[t])<0||s(e[t])>9)return!1;return i=7*s(e[0])+3*s(e[1])+1*s(e[2])+7*s(e[4])+3*s(e[5])+1*s(e[6])+7*s(e[7])+3*s(e[8]),(i%=10)===s(e[3])}}},r={onFieldValidateError:function(e,r,t){this.debug&&console.log("Fire onFieldValidateError")},onFieldValidateSuccessful:function(e,r){this.debug&&console.log("Fire onFieldValidateSuccessful")},onFormValidationError:function(e,r){this.debug&&console.log("Fire onFormValidationError")},onFormValidationSuccessful:function(e){this.debug&&console.log("Fire onFormValidationSuccessful")},beforeFieldValidation:function(e){this.debug&&console.log("Fire beforeFieldValidation")},afterFieldValidation:function(e){this.debug&&console.log("Fire afterFieldValidation")},beforeFormValidation:function(e){this.debug&&console.log("Fire beforeFormValidation")},afterFormValidation:function(e){this.debug&&console.log("Fire afterFormValidation")}},t={Rules:{Errors:{required:"This field is required.",phone:"Incorrect phone format. Should be exact 9 digits.",email:"Incorrect email address.",password:"Password is too week. Password should contain 1 uppercase, 1 lowercase, 1 digit, 1 special char and be greater or equal 9 chars.",pesel:"This field is invalid",regon:"This field is invalid",nip:"This field is invalid",idCard:"This field is invalid"}}},o={pl:{Rules:{Errors:{required:"To pole jest wymagane.",phone:"Nieprawidłowy numer telefonu. Musi to być dokładnie 9 cyfr.",email:"Nieprawidłowy adres e-mail.",password:"Hasło za słabe. Hasło powinno zawierać 1 wielką i małą literę, 1 cyfrę, 1 znak specjalny i mieć co najmniej 8 znaków.",pesel:"Podany pesel jest nieprawidłowy",regon:"Podany regon jest nieprawidłowy",nip:"Podany NIP jest nieprawidłowy",idCard:"Podany numer dowodu jest nieprawidłowy"}}},en:t};function i(o={}){o={...{debug:!1,constraints:{},errorWrapperClass:"form-errors-msgs",errorClass:"single-error-msg",errorPosition:"before",translations:t,language:"en",rules:e,...r},...o},Object.assign(this,o),t===o.translations?this._setTranslations(o.language,!0):this.debug&&console.log("Translations override by user custom translations passed.")}return i.prototype={construct:i,errors:{},form:null,_setTranslations:function(e,r=!1){if(r&&"en"===e)return;const t=o[e];void 0===t?(this.debug&&console.log(`Lang '${e}' is not supported yet. Load default.`),this.translations=o.en):(this.debug&&console.log(`Lang '${e}' set successful.`),this.translations=t)},_getDeepPropertyValue:function(e=this,r=""){let t=r.split("."),o=e;if(0===t.length)return this.debug&&console.log(`You shouldn't read anything from mains properties. Path: ${r}`),`You shouldn't read anything from main properties. Path: ${r}`;let i=function e(r,t){const o=r.shift();return void 0!==t[o]&&(t=t[o],0!==r.length?e(r,t):t)}(t,o);return!1===i?(this.debug&&(console.log(`Invalid property path: ${r}. Check your object below:`),console.log(o)),`BAD PROPERTY PATH: ${r}`):i},getTranslated:function(e){return this._getDeepPropertyValue(this.translations,e)},validateForm:function(e=null){if(null===e)return void console.log("You don't pass form element");this.form=e,this.removeAllErrorMessages(),this.beforeFormValidation(e),this.debug&&console.log(`Total form elements: ${e.elements.length}`);let r=[];for(let t=0;t<e.elements.length;t++)r.includes(e.elements[t].name)||(this.validateField(e.elements[t]),r.push(e.elements[t].name));this.afterFormValidation(e),this.isFormValid()?this.onFormValidationSuccessful(e):this.onFormValidationError(e,this.getErrors())},validateField:function(e=null,r=!1){if(null===e)return void(this.debug&&console.log("You don't pass a field"));const t=!1!==r?r:e.value,o=e.name,i=void 0!==this.constraints[o];if(""===o)return void(this.debug&&console.log(`${e} without name!`));if(!i)return void(this.debug&&console.log(`No constraints for ${o}`));this._removeFieldErrors(o,e),this.beforeFieldValidation(e);let n=[],s=[];const l=this.constraints[o];return Object.keys(l).map(r=>{let o=!0;void 0===this.rules[r]?this.debug&&console.log(`Rule not exists for: ${r}`):((o=this.rules[r].valid(t,e))||s.push(this.getTranslated(`Rules.Errors.${r}`)),n.push(o))}),this.afterFieldValidation(e),n.indexOf(!1)>=0?(this.onFieldValidateError(e,t,s),this._addFieldErrors(o,e,s),!1):(this.onFieldValidateSuccessful(e,t),this._removeFieldErrors(o,e),!0)},_removeFieldErrors:function(e,r){void 0!==this.errors[e]&&delete this.errors[e],this.removeErrorMessagesFromField(r,e)},_addFieldErrors:function(e,r,t){this.errors[e]=t,this.addErrorMessagesToField(e,t)},removeAllErrorMessages:function(){this.errors={},document.querySelectorAll(`.${this.errorWrapperClass}`).forEach(e=>{e.remove()})},removeErrorMessagesFromField:function(e=null,r=!1){if(null===e)return;e.parentElement.querySelectorAll(`.${this.errorWrapperClass}`).forEach(e=>{e.remove()})},addErrorMessagesToField:function(e=null,r){if(null===e||""===e)return void(this.debug&&console.log("No fieldName passed"));let t=document.createElement("DIV"),o=document.querySelector(`[name="${e}"]`),i=o.parentElement;t.classList.add(this.errorWrapperClass),r.forEach(e=>{let r=document.createElement("SPAN"),o=document.createTextNode(e);r.classList.add(this.errorClass),r.appendChild(o),t.appendChild(r)}),"after"===this.errorPosition?i.appendChild(t):i.insertBefore(t,o)},isFormValid:function(){return 0===Object.keys(this.errors).length},getErrors:function(){return!this.isFormValid()&&this.errors},debugMsg:function(e){console.log(e)}},i});
