!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):(e=e||self).Validator=o()}(this,function(){"use strict";"function"!=typeof Object.assign&&(Object.assign=function(e,o){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),t=1;t<arguments.length;t++){var i=arguments[t];if(null!=i)for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])}return r}),"NodeList"in window&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,o){o=o||window;for(var r=0;r<this.length;r++)e.call(o,this[r],r,this)});var e={required:{valid:(e,o)=>{if("radio"===o.type||"checkbox"===o.type){const e=document.getElementsByName(o.name);let r=!1;return e.forEach(e=>!!r||(e.checked?(r=!0,!0):void 0)),r}return"select"===o.type?""!==e:0!==e.length}},phone:{valid:(e,o)=>{return/([0-9]+){9}/.test(e)}},email:{valid:(e,o)=>{return/\S+@\S+\.\S+/.test(e)}},password:{valid:(e,o)=>{console.log(e);return new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\\$%\\^&])(?=.{8,})").test(e)}}},o={onFieldValidateError:function(e,o,r){this.debug&&console.log("Fire onFieldValidateError")},onFieldValidateSuccessful:function(e,o){this.debug&&console.log("Fire onFieldValidateSuccessful")},onFormValidationError:function(e,o){this.debug&&console.log("Fire onFormValidationError")},onFormValidationSuccessful:function(e){this.debug&&console.log("Fire onFormValidationSuccessful")},beforeFieldValidation:function(e){this.debug&&console.log("Fire beforeFieldValidation")},afterFieldValidation:function(e){this.debug&&console.log("Fire afterFieldValidation")},beforeFormValidation:function(e){this.debug&&console.log("Fire beforeFormValidation")},afterFormValidation:function(e){this.debug&&console.log("Fire afterFormValidation")}},r={Rules:{Errors:{required:"To pole jest wymagane",phone:"Niepoprawny format numeru",email:"Niepoprawny format adresu email",password:"Hasło zbyt słabe"}}};function t(t={}){t={...{debug:!1,constraints:{},errorWrapperClass:"form-errors-msgs",errorClass:"single-error-msg",errorPosition:"before",translations:r,rules:e,...o},...t},Object.assign(this,t)}return t.prototype={construct:t,errors:{},form:null,_getDeepPropertyValue:function(e=this,o=""){let r=o.split("."),t=e;if(0===r.length)return this.debug&&console.log(`You shouldn't read anything from mains properties. Path: ${o}`),`You shouldn't read anything from main properties. Path: ${o}`;let i=function e(o,r){const t=o.shift();return void 0!==r[t]&&(r=r[t],0!==o.length?e(o,r):r)}(r,t);return!1===i?(this.debug&&(console.log(`Invalid property path: ${o}. Check your object below:`),console.log(t)),`BAD PROPERTY PATH: ${o}`):i},getTranslated:function(e){return this._getDeepPropertyValue(this.translations,e)},validateForm:function(e=null){if(null===e)return void console.log("You don't pass form element");this.form=e,this.removeAllErrorMessages(),this.beforeFormValidation(e),this.debug&&console.log(`Total form elements: ${e.elements.length}`);let o=[];for(let r=0;r<e.elements.length;r++)o.includes(e.elements[r].name)||(this.validateField(e.elements[r]),o.push(e.elements[r].name));this.afterFormValidation(e),this.isFormValid()?this.onFormValidationSuccessful(e):this.onFormValidationError(e,this.getErrors())},validateField:function(e=null,o=!1){if(null===e)return void console.log("You don't pass a field");const r=!1!==o?o:e.value,t=e.name,i=void 0!==this.constraints[t];if(""===t)return void(this.debug&&console.log(`${e} without name!`));if(!i)return void(this.debug&&console.log(`No constraints for ${t}`));this._removeFieldErrors(t,e),this.beforeFieldValidation(e);let n=[],s=[];const l=this.constraints[t];return Object.keys(l).map(o=>{let t=!0;void 0===this.rules[o]?console.log(`Rule not exists for: ${o}`):((t=this.rules[o].valid(r,e))||s.push(this.getTranslated(`Rules.Errors.${o}`)),n.push(t))}),this.afterFieldValidation(e),n.indexOf(!1)>=0?(this.onFieldValidateError(e,r,s),this._addFieldErrors(t,e,s),!1):(this.onFieldValidateSuccessful(e,r),this._removeFieldErrors(t,e),!0)},_removeFieldErrors:function(e,o){void 0!==this.errors[e]&&delete this.errors[e],this.removeErrorMessagesFromField(o,e)},_addFieldErrors:function(e,o,r){this.errors[e]=r,this.addErrorMessagesToField(e,r)},removeAllErrorMessages:function(){this.errors={},document.querySelectorAll(`.${this.errorWrapperClass}`).forEach(e=>{e.remove()})},removeErrorMessagesFromField:function(e=null,o=!1){if(null===e)return;e.parentElement.querySelectorAll(`.${this.errorWrapperClass}`).forEach(e=>{e.remove()})},addErrorMessagesToField:function(e=null,o){if(null===e||""===e)return void console.log("No fieldName passed");let r=document.createElement("DIV"),t=document.querySelector(`[name="${e}"]`),i=t.parentElement;r.classList.add(this.errorWrapperClass),o.forEach(e=>{let o=document.createElement("SPAN"),t=document.createTextNode(e);o.classList.add(this.errorClass),o.appendChild(t),r.appendChild(o)}),"after"===this.errorPosition?i.appendChild(r):i.insertBefore(r,t)},isFormValid:function(){return 0===Object.keys(this.errors).length},getErrors:function(){return!this.isFormValid()&&this.errors},debugMsg:function(e){console.log(e)}},t});
